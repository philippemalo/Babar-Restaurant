---
import CustomScrollbar from "../components/CustomScrollbar.astro";
import Footer from "../components/Footer.astro";
import MobileNavbar from "../components/MobileNavbar.astro";
import Navbar from "../components/Navbar.astro";
import "../styles/global.css";
import MenuItem from "../components/MenuItem.astro";
import MenuContent from "../js/MenuContent";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <link rel="" type="" href="" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>Menu</title>
  </head>
  <body>
    <Navbar />
    <MobileNavbar />

    <div id="main-container">
      <div id="menu-img-container">
        <img id="deselect" src="/cancel_button.svg" />
      </div>

      <div id="menu-container">
        {
          MenuContent.map((menuItem, index) => (
            <MenuItem
              id={index}
              title={menuItem.title}
              description={menuItem.description}
              price={menuItem.price}
            />
          ))
        }
      </div>
    </div>

    <Footer />
    <CustomScrollbar />
  </body>
  <script defer>
    const MenuContent = [
      {
        title: "Olives, zaatar et citron",
        description: "",
        price: "7",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Trio de trempettes*",
        description: "Hummus, Mutabbal, Mouhamara",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Hummus",
        description: "Purée de pois chiche, huile d'olive et citron",
        price: "13",
        imagePortrait: "/foodPics/Hummus_Portrait.jpg",
        imageLandscape: "/foodPics/Hummus_Landscape.jpg",
      },
      {
        title: "Mutabbal*",
        description: "Purée d'aubergine grillée, yogourt et grenade",
        price: "13",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Muhammara*",
        description:
          "Purée de poivron rouge et noix de Grenoble, mélasse de grenade",
        price: "13",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Kefta d'agneau",
        description: "Fromage feta, concombre et sauce au yogourt",
        price: "19",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Hummus All Dressed",
        description:
          "Filet mignon sept épices, sauce yogourt, grenade et pousse de coriandre",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Choux de Bruxelles",
        description:
          "Raisins, sirop d'érable, noix de Grenoble et yogourt à la menthe",
        price: "15",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Halloumi sur charbon",
        description:
          "Fenouil, céleri, datte, vinaigrette au babeurre, miel et piment d'Alep",
        price: "21",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Kibbeh Nayeh",
        description: "Boeuf, agneau, boulgour, oignon, menthe et pita au sumac",
        price: "24",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Pieuvre sur charbon",
        description: "Hummus de pois jaune, tomate, huile d'olive et persil",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Côtelettes d'agneau",
        description:
          "Croûte de fines herbes, riz frit, légumes rôtis et glace de viande",
        price: "55",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Filet mignon",
        description:
          "Marinade sept épices, patate à l'ail, légumes marinés et taboulé",
        price: "63",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "*Extra crudités",
        description: "",
        price: "7",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Patates à l'ail (mon ami)",
        description: "",
        price: "10",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Carottes au harissa",
        description: "Labneh et miel au sumac",
        price: "15",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Bahis à l'oignon",
        description: "Sauce Tarator et salsa verde",
        price: "14",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Falafels",
        description: "Taboulé et sauce à l'ail",
        price: "14",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Mujaddara",
        description:
          "Riz frit, vermicelle de blé, légumes rôtis, sauce au yogourt et noix",
        price: "20",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Choux-Fleurs frits",
        description: "Mélange d'épices, sauce à l'ail et citron",
        price: "16",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Salade Fattouch",
        description:
          "Laitue, poivron, concombre, tomate, persil, menthe, pita sumac et zaatar",
        price: "22",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Salade de tomate",
        description:
          "Poivron, concombre, oignon, citron, huile d'olive et fromage feta",
        price: "20",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Dumplings",
        description:
          "Boeuf, agneau, sauce yogourt, beurre au piment d'Alep, noix de pin, grenade et coriandre",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Crevettes géantes",
        description: "Marinade sumac et ail, chimichurri",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Shish Taouk",
        description:
          "Poitrine de poulet marinée au yogourt, pomme de terre, légumes marinés et taboulé",
        price: "34",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Morue",
        description:
          "Riz frit, légumes rôtis, sauce romesco, fromage feta et mélange de noix",
        price: "28",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
      {
        title: "Assiette du Grill à Michel",
        description:
          "Shish Taouk, filet mignon, agneau, riz frit, patate à l'ail et légumes rôtis sur charbon (Pour 4 personnes)",
        price: "150",
        imagePortrait: "/foodPics/tomato_portrait.jpg",
        imageLandscape: "/foodPics/tomato_landscape.jpg",
      },
    ];

    const mainContainer = document.querySelector("#main-container");
    const menuImgContainer = document.querySelector("#menu-img-container");
    const deselectButton = document.querySelector("#deselect");

    let selectedMenuItem = null;
    let menuContentItem = null;

    deselectButton.addEventListener("click", () => {
      selectedMenuItem.style.borderColor = "transparent";
      selectedMenuItem.style.backgroundColor = null;
      menuImgContainer.style.display = "none";
      selectedMenuItem = null;
      menuContentItem = null;
      let imgToRemove = document.getElementById("food-image");
      imgToRemove.remove();
    });

    const aspectRatioStyling = () => {
      let aspectRatio = window.innerWidth / window.innerHeight;

      if (aspectRatio < 1) {
        mainContainer.style.flexDirection = "column";
        mainContainer.style.alignItems = "center";
        menuImgContainer.style.width = "100%";
        menuImgContainer.style.maxHeight = "30vh";
        menuImgContainer.style.maxWidth = "500px";
        menuImgContainer.style.margin = "auto";
        // update image for portrait to landscape
        menuImgContainer.firstElementChild.src = menuContentItem.imageLandscape;
      } else {
        mainContainer.style.flexDirection = "row";
        menuImgContainer.style.width = "50%";
        menuImgContainer.style.maxWidth = "750px";
        menuImgContainer.style.maxHeight = "calc(100vh - 200px)";
        menuImgContainer.style.margin = "1rem";
        // update image for landscape to portrait
        menuImgContainer.firstElementChild.src = menuContentItem.imagePortrait;
      }
    };

    const menuItems = document.querySelectorAll(".menu-item");
    menuItems.forEach((item) => {
      item.addEventListener("click", () => {
        // If a menu item is already selected and the user selects another
        if (selectedMenuItem && item !== selectedMenuItem) {
          selectedMenuItem.style.borderColor = "transparent";
          selectedMenuItem.style.backgroundColor = null;
          let imgToRemove = document.getElementById("food-image");
          imgToRemove.remove();
        }

        // If the user selects a menu item that isn't already selected
        if (selectedMenuItem !== item) {
          selectedMenuItem = item;
          menuContentItem = MenuContent.find(
            (food) =>
              food.title ===
              item.firstElementChild.firstElementChild.textContent
          );

          item.style.borderColor = "black";
          selectedMenuItem.style.backgroundColor = "#F0BD3F";
          menuImgContainer.style.display = "block";

          let imgElement = document.createElement("img");
          imgElement.id = "food-image";
          imgElement.src =
            window.innerWidth / window.innerHeight > 1
              ? menuContentItem.imagePortrait
              : menuContentItem.imageLandscape;
          imgElement.style.width = "100%";
          imgElement.style.height = "100%";
          imgElement.style.objectFit = "cover";
          menuImgContainer.insertBefore(imgElement, deselectButton);
        }
        // If the user selects a menu item that is already selected
        else {
          selectedMenuItem = null;
          menuContentItem = null;
          item.style.borderColor = "transparent";
          item.style.backgroundColor = null;
          let imgToRemove = document.getElementById("food-image");
          imgToRemove.remove();
          menuImgContainer.style.display = "none";
        }

        menuContentItem && aspectRatioStyling();
      });
    });

    addEventListener("resize", () => menuContentItem && aspectRatioStyling());
  </script>
</html>

<style>
  #main-container {
    display: flex;
    width: 100%;
    justify-content: center;
    /* height: calc(100vh - 200px); */
  }
  #menu-container {
    display: flex;
    flex-direction: column;
    overflow-y: scroll;
    height: calc(100vh - 200px);
    margin: 1rem;
    padding: 1rem;
    border-radius: 5px;
    max-width: 500px;
    box-shadow: inset 0 0 10px #0000004f;
    transition: all 0.3s ease-in-out;
  }

  #menu-img-container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 50%;
    max-width: 750px;
    overflow: hidden;
    margin: 1rem;
    height: calc(100vh - 200px);
    display: none;
    position: relative;
    border-radius: 5px;
  }
  #deselect {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 33px;
    height: 33px;
    cursor: pointer;
    transition: all 0.3s ease-in-out;
  }
  #deselect:hover {
    width: 36px;
    height: 36px;
  }
  @media screen and (max-width: 500px) {
    #menu-container {
      max-width: 90%;
    }
  }
  @media screen and (min-width: 501px) {
    #menu-container {
    }
  }
</style>
